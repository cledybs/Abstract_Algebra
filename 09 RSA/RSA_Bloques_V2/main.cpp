#include <iostream>
#include "rsa_bloques.h"
using namespace std;

int main(){
    string mensaje;
    //mensaje = "14528965768692212464514517406723554203544686364758305235266123509647840842543632870195843224307110712887566167217735721293764990249356182694595208800957367290357809942796861500213075730121477225636405496834034844096297127429341217264121741213069265698663062528372832216383117837739178979208004980415119077390942830357740105224496789111067270228068183275437127651859857477456526942913633235451610133075394762729005214778401980648948372935980358009508177308322145144377253811064743693768403900646310489233327482032627117244044696108851761899037904102345056775527199114845929834668146519946525313270214149446442540412317070936624171655011189394879403523801231218223482587101513466694032406303309607939251127752204920675347006194355594793863605724942364286640623232828467827410537809061241482237998774841431529145970189680189473889571120823800679986148646093329150063181778878488063627311577633389392067753819721963425197819048636777462664911585620127339826480806974098373486345975644987012890938170892028621662971532215556110089884809242997973522060182461835801476690690776205566892949454835626317337827042470031359711810548965527760906223729577277851901891899335446228945825702559268603011916532852881980118508386978792211368895550830301415013048282277214083861868597846168970616524405052866863014453991171315690635556556626359015023571493843296941242013400367191897465108152768351284466670337170993552517823508346433695898361795525053377704370790322234676954409134331407804602042331745549605046573810787575525689976464602006719095078426404336617368570344751037579459563613848628096266151091211248480040664818497148638566766366131403640213605122326451485392978146863925918756694434332287719579105277989308973544562664043781121192974300237236792568764062766743185077192163953636417241763212506659322914920160079064283956395954369332586368670962659979780308356177531673687861781069817326960944703671738182828851338252219311323341691874871012995721762431709910231618740198975013839342181384136487198127134996217108227338815187072215235544223749671290709626227854137469545717899049350140902534570970328494740943287595764407091150672154925154520175075674913490473627571528274085211873816361642069378423482165785436416997050082893468520512894822773391064002107734219840055640279188400490595600226620959954231343740696568138083419419887530536406824042986487241014966823346542521081900052542933481859814080263822122324959646709446747836713762595672920480541625480764041548685979";
    mensaje = "01223019096694238016762060788352901072397357849449158841128943215731013205641073225711584270038911172382485740687097158399219263423251923642790504692548715975686737533397390020327089772017755186866580700984254775663842955088081256043695437957929851191420428647205683282782635164929568877212762770465824088031809027666771592623613544002786266053879066000538493109511382481385264711126435862446782552344159999396150901658185398187309436458276559771453555052723538972251999470118714363866238609271713922416429423443777821142308013261777223486085782329187574738559931566745890835783279254140395522665099995121073605497788";
    rsa_bloques receptor(1024);//genera claves y recibe mensaje
    //rsa_bloques receptor(10);
/*
    ZZ n= conv<ZZ>("15797965527125379554895451884980503128283501264067180811602973361605815492417140248938992156520385401127509616818400436058641353273148053920905946275909616422117591834810174080280415835073918925915449555540803821466083729608952430945443417552740478349871590109748748031389298399449104890233941379117292949195530466330927205654650234511046614491786471752713765775872756724121772444754621884866185651306615820507558013614946291466376534642372458765420132473707378628673897790352451168740168234378558645864138591663211547334332208365852955079332681957980798299761279420424853403315120033115594268475184373898700327667101");
    ZZ e= conv<ZZ>("118831771744614267884036168004006690066504645352011370129391916764391780293048861973550184496682081579622056644769615336918162659304713710594754645459116635721407805930018503066008815302178554106599701452495570354353770312280468040655537534370080874682166156791589728565770080678017522614928691686579641699591");//*/
    /*
    ZZ n,e;
    cin>>n>>e;//*/
/*
   rsa_bloques emisor(n,e);//recibe claves <n,e> y encripta mensaje
    cout<<"\nmensaje cifrado: "<<endl<<emisor.encrypt(mensaje)<<endl;//*/

    //cin>>mensaje;
    cout<< "\ndecifrado: \n" <<receptor.decrypt(mensaje);//*/
    return 0;
}
